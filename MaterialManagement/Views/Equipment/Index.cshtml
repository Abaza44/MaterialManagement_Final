@{
    ViewData["Title"] = "إدارة المعدات";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h1><i class="bi bi-tools"></i> @ViewData["Title"]</h1>
    <a asp-action="Create" class="btn btn-primary">
        <i class="bi bi-plus-circle"></i> إضافة معدة جديدة
    </a>
</div>

<div class="card shadow-sm">
    <div class="card-header">
        <h5 class="mb-0">قائمة المعدات</h5>
    </div>
    <div class="card-body">
        <table id="equipmentTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>الكود</th>
                    <th>الاسم</th>
                    <th>تاريخ الشراء</th>
                    <th>آخر صيانة</th>
                    <th>الإجراءات</th>
                </tr>
            </thead>
        </table>
    </div>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {
            $('#equipmentTable').DataTable({
                "processing": true,
                "serverSide": true,
                "ajax": {
                    "url": "/Equipment/LoadData",
                    "type": "POST"
                },
                "columns": [
                    { "data": "code" },
                    { "data": "name" },
                    {
                        "data": "purchaseDate",
                        "render": function(data) {
                            return new Date(data).toLocaleDateString('ar-EG-u-nu-latn', { year: 'numeric', month: 'long', day: 'numeric' });
                        }
                    },
                    {
                        "data": "lastMaintenanceDate",
                        "render": function(data) {
                            return data ? new Date(data).toLocaleDateString('ar-EG-u-nu-latn', { year: 'numeric', month: 'long', day: 'numeric' }) : '---';
                        }
                    },
                    {
                        "data": "code",
                        "render": function (data) {
                            return `<div class="btn-group btn-group-sm">
                                        <a href='/Equipment/Details/${data}' class='btn btn-outline-info' title='تفاصيل'><i class='bi bi-eye'></i></a>
                                        <a href='/Equipment/Edit/${data}' class='btn btn-outline-warning' title='تعديل'><i class='bi bi-pencil'></i></a>
                                        <a href='/Equipment/Delete/${data}' class='btn btn-outline-danger' title='حذف'><i class='bi bi-trash'></i></a>
                                    </div>`;
                        },
                        "orderable": false,
                        "searchable": false
                    }
                ],
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/1.13.6/i18n/Arabic.json"
                }
            });
        });
    </script>
}